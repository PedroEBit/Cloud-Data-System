name: Automatic CSV Upload to Azure Storage

on:
  push:
    branches:
      - main  # Gatilho: executa quando h치 um push para a branch 'main'

jobs:
  upload-data:
    runs-on: ubuntu-latest

    steps:
    - name: 拘勇 Checkout do Reposit칩rio
      uses: actions/checkout@v4

    - name: 游냀 Configurar Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.x'

    - name: 游닍 Instalar depend칡ncias da Azure SDK
      run: pip install azure-storage-blob

    # --- Se estiver usando um Azure Storage Account Real ---
    # Ajuste o script 'upload_to_azurite.py' para ler a string de conex칚o de uma vari치vel de ambiente.
    - name: 丘뙖잺 Configurar String de Conex칚o (Real Azure Storage)
      run: |
        # Substitua a string de conex칚o no script para usar a Secret do GitHub
        # AZURITE_CONNECTION_STRING = os.environ.get("AZURE_STORAGE_CONNECTION_STRING")
        sed -i 's|AZURITE_CONNECTION_STRING = .*|AZURITE_CONNECTION_STRING = os.environ.get("AZURE_STORAGE_CONNECTION_STRING")|g' upload_to_azurite.py
      # O Secret "AZURE_STORAGE_CONNECTION_STRING" deve ser configurado nas Settings do seu reposit칩rio.

    - name: 拘勇 Executar Upload do CSV
      env:
        # Passa o secret de forma segura como vari치vel de ambiente
        AZURE_STORAGE_CONNECTION_STRING: ${{ secrets.AZURE_STORAGE_CONNECTION_STRING }}
      run: python upload_to_azurite.py